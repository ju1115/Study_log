---
title: "Next.js_이미지관리"
date: "2026-01-01"
category: "Language & Framework"
tags: [Next.js, Optimization, Best Practices]
description: "Next.js의 Image 컴포넌트 활용법과 현업 표준 디렉토리 구조(src/assets vs public) 및 보안 업데이트 정리."
---

# 🛠️ `Next.js_이미지관리`

## 🎯 Goal (목표)
- **보안 이슈 해결:** `npm audit`에서 발견된 Next.js Critical 취약점을 안전하게 해결한다.
- **이미지 경로 수정:** `public` 폴더 경로 인식 문제(`/public` vs `/`)를 해결하여 이미지를 정상적으로 출력한다.
- **최적화 적용:** 현업 표준인 **Static Import** 방식을 도입하여 CLS(Layout Shift) 방지 및 로딩 성능을 최적화한다.

## 💻 Implementation (구현 과정)

### Step 1. Setup (Security Fix)
`npm audit fix --force`를 바로 사용하지 않고, 패키지 버전을 명시적으로 올려 안전하게 업데이트함.

```bash
# 1. 현재 상태 백업 (권장)
git add .
git commit -m "backup before update"

# 2. Next.js 최신 안정 버전으로 수동 업데이트 (의존성 문제 해결)
npm install next@latest

# 3. 취약점 해결 확인
npm audit
```

### Step 2. Code Snippet (Modern Image Usage)
이미지 파일을 `public`에서 `src/assets`로 이동 후 **Static Import** 방식으로 변경.

**변경 전 (Legacy/Anti-pattern):**
```tsx
// public 폴더에 의존하는 문자열 경로 방식
<Image 
  src="/public/profile_front_view.jpg" // ❌ 잘못된 경로 (public 포함 안 됨)
  // src="/profile_front_view.jpg"     // 🔺 가능은 하지만 최적화 덜 됨
  alt="Profile" 
  fill 
/>
```

**변경 후 (Modern/Best Practice):**
```tsx
// 1. 이미지 파일을 모듈로 Import (경로: src/assets/images/...)
import profileImg from '@/assets/images/profile_front_view.jpg'; 

export default function Hero() {
  return (
    <div className="relative aspect-square w-full max-w-[400px]">
      {/* 2. src 속성에 import한 변수 할당 */}
      <Image 
        src={profileImg} 
        alt="Profile" 
        fill 
        className="object-cover" 
        priority={true}       // LCP 최적화 (첫 화면 중요 이미지)
        placeholder="blur"    // 로딩 중 흐릿한 미리보기 자동 생성
      />
    </div>
  );
}
```

## 💡 Best Practices

- **현업에서는 주로 이렇게 사용함:**
    - **`src/assets` (내부 관리용):** 컴포넌트 디자인에 포함된 정적 이미지(아이콘, 로고, 프로필 등)는 이곳에 위치시킴. `import` 방식을 사용하여 빌드 타임에 이미지 크기를 미리 계산하고, **Layout Shift(화면 덜컥거림)**를 방지함. 파일명에 Hash가 붙어 캐싱 문제(구버전 이미지 로딩)를 자동 해결함.
    - **`public` (외부 노출용):** URL로 직접 접근해야 하는 파일(`favicon.ico`, `robots.txt`, `og-image`)만 제한적으로 사용.

- **주의할 점 (Gotchas):**
    - **경로 실수:** `public` 폴더 사용 시 코드에 `/public`을 포함하면 안 됨. (루트 `/`로 인식)
    - **`fill` 속성 사용 조건:** `<Image fill />`을 사용할 때는 반드시 **부모 요소(Container)**에 `position: relative`와 명시적인 `width/height`가 설정되어 있어야 함.
    - **보안 업데이트:** `npm audit` 경고 시 무조건 `--force`를 쓰지 말고, 메이저 버전 변경 여부를 확인 후 수동 업데이트(`install package@latest`)하는 것이 안전함.